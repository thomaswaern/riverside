"use strict";var app;var App=function(d){var e="record";var b={crackling:new Audio("sounds/needle.ogg"),end:new Audio("sounds/endloop.ogg"),channel:new Audio("sounds/btn.ogg"),dial:new Audio("sounds/dial_short.ogg"),dialBack:new Audio("sounds/dialback.ogg"),dialEnd:new Audio("sounds/dialend.ogg"),tv:new Audio("sounds/tv.ogg"),wrongnumber:new Audio("sounds/wrongnumber.ogg"),dialtone:new Audio("sounds/dialtone.ogg"),answer:new Audio("sounds/answer.ogg")};
var a=[];var c=[];return{pages:a,playSoundEffect:function(g,f){b[g].loop=f;b[g].play();return b[g];},addPage:function(g,f){a[g]=f;c.push(g);},stopAllSounds:function(){for(var f in b){b[f].pause();
}},sound:function(f){return b[f];},prepare:function(){if((navigator.userAgent.match(/iPhone/i))||(navigator.userAgent.match(/iPod/i))||(navigator.userAgent.match(/iPad/i))){document.write('<a id="init" ontouchstart="javascript:sndInit();"></a>');
window.sndInit=function(){snd.play();snd.pause();document.getElementById("init").style.display="none";};}d(".switch > div").noUiSlider({start:0,orientation:"vertical",handles:1,step:1,behaviour:"extend-tap",range:{min:0,max:2}}).on({slide:function(g){var f=parseInt(Math.floor(d(this).val()));
app.load(c[f]);},set:function(f){if(typeof(app.pages.television[d(f.target).data("control")])==="function"){app.pages.television[d(f.target).data("control")](d(this).val());
}}});d("a[href*=#]:not([href=#])").on("click",function(g){var f=this.hash.slice(1);app.load(f);d(".switch > div").val(d(this).data("index"));g.preventDefault();
});},getCurrentPage:function(){return e;},load:function(f){ga("send","event","app","loadPage",f);d.ajax({context:this,dataType:"html",url:"pages/"+f+".html",success:function(g){if(typeof(this.pages[e].unload)==="function"){this.pages[e].unload();
}d("#wrapper").html(g);e=f;this.stopAllSounds();this.pages[f].prepare();}.bind(this)});}};};var Contact=function(i){var k,m,b="",l,g=false,a=false;var n=[["+46(0)708-138138","tel:0708138138","_self"],["hey@riverside.com","mailto:hey@riverside.com","_blank"],["Youtube","http://youtube.com/user/riversidesoc","_blank"],["Soundcloud","http://soundcloud.com/riverside-society","_blank"],["Twitter","http://twitter.com/riversidesoc","_blank"],["Facebook","","_blank"],["Instagram","http://instagram.com/riversidesociety","_blank"]];
var c=function(){a=false;app.playSoundEffect("answer",false);b="";g=true;i(".ring").addClass("active");app.pages.contact.instance.enable();};var f=function(){a=true;
app.pages.contact.instance.disable();app.playSoundEffect("dialtone",true);var o=Math.random()*10000+3000;ga("send","event","contact","calling","wait",o);
setTimeout(function(){if(app.getCurrentPage()==="contact"){app.stopAllSounds();c();}},o);};var h=function(){var p=i(l).index();ga("send","event","contact","link",n[p][0]);
var o=i("<a/>",{href:n[p][1],target:n[p][2],text:n[p][0]});i(".note").html(o);};var e=function(){if(g){return;}b+=l.text();d(b);i(".note").text(b);};var d=function(o){ga("send","event","contact","number",o);
if(o.length>=5){if(o===window.contactCode){app.pages.contact.instance.disable();f();}else{app.playSoundEffect("wrongnumber",false);b="";ga("send","event","contact","wrongnumber",o);
}}};var j=function(o){l=o;};return{prepare:function(){var o=this;b="";g=false;a=false;Draggable.create(".ring",{type:"rotation",trigger:".ring .links",dragResistance:0,bounds:{minRotation:0,maxRotation:0},throwProps:false,onPress:function(p){app.pages.contact.instance=this;
if(p.target.nodeName!=="LI"){k=0;}else{k=(i(p.target).index())*29+55;j(i(p.target));}this.applyBounds({minRotation:0,maxRotation:k});},onDrag:function(p){if(this.rotation>10){app.playSoundEffect("dial",false);
}if(this.rotation===this.maxRotation&&(p.type==="mousemove"||p.type==="touchmove")){app.pages.contact.instance.disable();if(g){h();}else{e();}}},onDragEnd:function(q){if(q.target.nodeName==="DIV"||q.target.nodeName==="UL"||q.target.nodeName==="LI"){app.pages.contact.instance.disable();
}else{this.kill();}var p=i(".ring");app.stopAllSounds();app.playSoundEffect("dialBack",false);TweenMax.to(p,k/400,{rotation:0,onComplete:function(){app.playSoundEffect("dialEnd",false);
if(!a){app.pages.contact.instance.enable();}}});}});}};};var Television=function(c){var u=document.createElement("script");u.src="https://www.youtube.com/iframe_api";
var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(u,s);var o;var h=[],e=[];var k;var m=false;var p=function(){k=0;if(!o){o=new YT.Player("iframe",{height:"390",width:"640",volume:100,videoId:h[k],events:{onReady:n,onStateChange:d}});
}else{g(h[k]);}};var j=function(v){ga("send","event","television","loadPlaylist",v);var w="http://gdata.youtube.com/feeds/api/playlists/"+v+"?v=2&alt=json&callback=?";
c.getJSON(w,function(x){h=[];c.each(x.feed.entry,function(B,C){var E=C.title.$t;var z=C.link[1].href;var y=z.split("/");var D=y[y.length-2];var A="http://img.youtube.com/vi/"+D+"/default.jpg";
h.push(D);});p();});};var l=function(w){var v="https://gdata.youtube.com/feeds/api/users/"+w+"/playlists?v=2&alt=json&callback=?";c.getJSON(v,function(y){var x="";
c.each(y.feed.entry,function(z,B){var A=B.yt$playlistId.$t;e.push(A);if(A!="videos"){x+='<li><a href="" data-id="'+A+'"></a></li>';}});c(x).prependTo("ul.channels");
c("ul.channels li:eq(0) a").addClass("active");j(e[0]);});};var b=function(v){app.playSoundEffect("tv",true);app.sound("tv").volume=0;o=null;l("riversidesoc");
c(".controls .prev").on("click",function(w){w.preventDefault();q();});c(".controls .next").on("click",function(w){w.preventDefault();t();});c(".channels").on("click","li",function(z){z.preventDefault();
var w=c(z.target).closest("li"),x=w.find("a"),A=c(".channels");if(w.find("a").data("id")){var y=x.data("id");j(y);app.playSoundEffect("channel",false);
w.siblings().find("a").removeClass("active");x.addClass("active");}else{ga("send","event","television","turnoff",h[k]);o.stopVideo();h=[];app.playSoundEffect("channel",false);
A.find("a").removeClass("active");A.find("li:last a").addClass("active");}});c(".sliders div").each(function(w,x){c(x).css("height",c(".sliders").outerHeight());
c(x).noUiSlider({start:100,direction:"rtl",orientation:"vertical",handles:1,range:{min:0,max:100}}).on({slide:function(y){if(typeof(app.pages.television[c(y.target).data("control")])==="function"){app.pages.television[c(y.target).data("control")](c(this).val());
}},set:function(y){if(typeof(app.pages.television[c(y.target).data("control")])==="function"){app.pages.television[c(y.target).data("control")](c(this).val());
}}});});};var d=function(v){if(v.data===YT.PlayerState.PLAYING&&!m){setTimeout(r,6000);m=true;}if(v.data===YT.PlayerState.ENDED){t();}if(m){c("#player iframe").css("opacity",1);
app.sound("tv").volume=0;}};function q(){ga("send","event","television","skipToNext",h[k]);if(k>0){k--;}else{k=h.length-1;}g(h[k]);}function t(){if(k<h.length-1){k++;
}else{k=0;}g(h[k]);}function r(){}var n=function(v){v.target.playVideo();c("#player iframe").css("opacity",1);};var g=function(v){ga("send","event","television","load",v);
if(h.length>0){c("#player iframe").css("opacity",0.3);app.sound("tv").volume=0.4;setTimeout(function(){o.loadVideoById(v,5,"large");},500);}};var i=function(v){o.setVolume(v);
};var f=function(v){if(h.length>0){c("#player iframe").css("opacity",v/100);app.sound("tv").volume=1-(v/100);}};var a=function(v){};return{prepare:b,load:g,volume:i,brightness:f,saturation:a};
};var Record=function(c){var a=[];var d;var b=0;var f=0;var e=0;return{getCurrentTrack:function(){return a[f];},setCurrentTrack:function(g){f=g;},setTracks:function(g){a=g;
b=0;a.forEach(function(h){b+=h.duration;});this.setLabel();},setLabel:function(){var h="",g=1;a.forEach(function(i){h+="<br>";h+=(g++)+". ";h+=i.title.substr(0,i.title.indexOf(" -"));
});c(".record").find(".title").html(h);},onPosition:function(){var g=e+d.position;this.setArmRotation(g/b);},setArmRotation:function(g){var h=((1-g)*(75-24));
c(".slider").val(h+24,true);},prepare:function(){SC.whenStreamingReady(function(){setTimeout(function(){SC.get("/playlists/2373914",function(g){if(g.artwork_url){c(".record label").css("background-image","url("+g.artwork_url+")");
}app.pages.record.setTracks(g.tracks);if(app.getCurrentPage()==="record"){app.pages.record.init();}}.bind(this));}.bind(this),2200);}.bind(this));},init:function(){c(".slider").noUiSlider({start:24,handles:1,range:{min:24,max:75}});
c(".slider").change(function(g){app.pages.record.armMoving=false;app.pages.record.setPosition(c(g.target).val(),24,75);}.bind(this));c(".slider").on({slide:function(){app.pages.record.armMoving=true;
c(".arm").css("-webkit-animation","none");c(".arm").css("-webkit-transform","rotate(-"+c(".slider").val()+"deg)");c(".slider").css("-webkit-transform","rotate(-"+c(".slider").val()/3+"deg)");
},set:function(){c(".arm").css("-webkit-transform","rotate(-"+c(".slider").val()+"deg)");}});c(".arm").css("-webkit-animation","wobblearm 4.3s infinite");
c(".record").css("-webkit-animation","rotating 4.3s linear infinite");app.playSoundEffect("end",true);},setPosition:function(k,j,m){var o=1-(k-j)/(m-j),g=b*o,i;
var l=0,h=0,n=false;a.forEach(function(p){if(!n){l+=p.duration;if(g<l){i=g-(l-p.duration);e=(l-p.duration);n=true;}else{h++;}}});if((d&&d.playState>0)&&(f===h)){d.setPosition(i);
}else{f=h;this.playCurrentTrack(i);}ga("send","event","record","setPosition",this.getCurrentTrack().id+" ("+i+")");},next:function(){e+=a[f].duration;try{d.stop();
}catch(g){}if(f>=(a.length-1)){c(".arm").css("-webkit-animation","wobblearm 4.3s infinite");}else{f++;this.playCurrentTrack(0);}ga("send","event","record","next",this.getCurrentTrack().id);
},playCurrentTrack:function(g){try{d.stop();}catch(h){}if(this.getCurrentTrack()&&this.getCurrentTrack()!=="undefined"){SC.stream("/tracks/"+this.getCurrentTrack().id,{whileplaying:function(){if(!app.pages.record.armMoving&&d.loaded){this.onPosition();
}}.bind(this),autoLoad:true},function(i){d=i;app.playSoundEffect("crackling",false);d.setVolume(0);d.play({onload:function(){d.setVolume(90);d.setPosition(g);
},onfinish:function(){console.log(this);this.next();}.bind(this)});}.bind(this));}},unload:function(){try{d.stop();}catch(g){}},initSoundcloud:this.initSoundcloud};
};$(document).ready(function(){app.prepare();});app=new App(jQuery);app.addPage("record",new Record(jQuery));app.addPage("television",new Television(jQuery));
app.addPage("contact",new Contact(jQuery));app.load("record");